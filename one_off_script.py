from qdrant_client import QdrantClient
import os
from dotenv import load_dotenv

load_dotenv()

# Replace with your Azure Container App's FQDN
QDRANT_FQDN = os.getenv('QDRANT_URL')

# Connect to Qdrant via the container app's public FQDN on the default REST port (443 for HTTPS)
client = QdrantClient(
    url=f"{QDRANT_FQDN}",
    port=443  # Default HTTPS port
)

# Example: List collections to verify connection
collections = client.get_collections()
print("Collections:", collections)

# Example: Find points in a collection and print payloads
collection_name = "legal_docs"  # Replace with your actual collection name

# Vector for nearest neighbor search - example with a vector of 4 zeros
query_vector = [-0.025664348,0.051577203,-0.011163172,-0.016981337,0.087767564,0.0040406487,0.03263324,0.008006803,-0.02105134,-0.025754374,0.006367599,-0.04811328,-0.0021993166,-0.0035965317,-0.017148027,0.03202104,0.035933018,0.0077406783,-0.04727732,0.0071852105,0.046382904,-0.009045516,0.014120655,0.028781096,0.024051242,0.0272101,0.0010821624,-0.018862128,-0.041900106,0.00720879,0.037681118,-0.029151635,-0.0062219934,-0.031048955,0.0013682715,-0.007139809,-0.04229158,-0.026171833,0.024665702,-0.004894704,-0.020595511,-0.025519678,0.010092973,-0.0140911825,-0.04275681,-0.041890405,-0.014811485,-0.03197155,-0.040293407,-0.008414748,0.008540826,0.019080317,0.023023859,-0.0029788238,0.011162792,0.008012202,-0.036365982,-0.06953876,-0.055526547,-0.03252632,0.0033189547,-0.0038232657,0.007898737,0.000648152,-0.022299409,0.037983418,0.006390485,0.016272146,-0.02806223,-0.015273845,-0.008923271,0.009377508,0.011884334,-0.0011575058,-0.007138954,0.01241947,-0.007264208,0.03718177,0.031131072,0.029051986,-0.009541524,0.03978446,0.024422012,-0.00033667622,-0.004502287,-0.032866385,0.0030398741,0.043508053,-0.04003689,0.061275754,0.01658421,-0.009707451,0.011704304,0.0051891925,0.038746674,0.030458722,0.00798153,0.027405268,0.015103113,0.007843493,0.015674882,-0.049782682,0.002039706,0.02815629,0.019836135,0.0011523922,-0.011907649,0.008663106,-0.04514341,0.06915238,0.017302262,0.013127149,0.01131228,-0.05829118,0.008067454,-0.00031964522,-0.009366723,0.004404162,-0.009674893,0.0042177453,0.024570726,0.017703194,0.009559729,0.026630903,0.025112314,-0.0021258693,0.0114614265,0.02723916,0.015211172,-0.038909774,-0.02385552,0.054601964,-0.020093348,0.0046410314,-0.04428552,-0.005006394,0.014470192,-0.050154403,-0.0075849737,-0.012819925,0.060125407,-0.019574378,0.0054025482,-0.0081452755,0.00779488,-0.004663612,-0.007813122,0.0067621307,-0.021590928,0.027420701,0.009938609,0.0048808292,0.01431578,-0.027447216,-0.04311886,0.0011301577,-0.0012550105,0.027964432,-0.019667123,0.013366255,-0.031154232,0.0031046914,-0.016046023,0.009916691,0.043220583,-0.005480838,0.016308868,-0.010574048,-0.039229643,-0.0024832613,0.009880963,0.010305275,0.05217367,0.025512073,-0.011892538,-0.03570412,0.007961463,0.030588018,0.03809522,-0.0035119753,-0.08035914,0.020927876,0.009225291,0.017025989,0.0016944549,-0.0073625166,0.060090873,0.004206428,0.020652618,-0.04381942,-0.024484478,-0.04351381,0.011703735,-0.026978936,0.033302642,-0.014513449,-0.030428726,0.008541183,0.006869185,-0.018459842,0.04574455,0.0052750004,0.008225304,-0.010125735,-0.0025457297,-0.050155785,0.034465104,-0.019995857,0.036729455,-0.006581789,0.002594874,-0.03569967,0.027214942,0.031910174,-0.029508555,0.01340002,0.028627716,0.017629797,0.042707372,0.009726386,-0.010861947,0.02203665,-0.031015147,0.03452197,-0.040435363,0.08112711,-0.031136949,-0.03164575,0.021861091,0.036563594,0.0026102457,-0.011248962,0.05050767,-0.011315434,-0.0004920755,0.02082932,-0.011859772,-0.0018980419,0.03818665,-0.021362327,-0.015287941,0.034111917,-0.012432778,0.007391397,0.012194805,-0.012223851,-0.041181423,-0.010726421,0.017088674,-0.034986433,-0.048803646,-0.0042320164,0.016970458,-0.018126598,-0.039351664,0.010301485,-0.015646318,-0.0418594,-0.0063618515,-0.025477305,0.027584683,-0.0076988935,-0.00063939206,0.0018570934,-0.01899304,-0.024047757,0.015117346,0.03469717,0.054842222,0.036394455,0.041241102,0.025071489,-0.0039393473,0.086419076,0.008772678,0.012740219,0.03697941,0.02011118,0.010831224,-0.039741706,0.0035430288,0.032070536,-0.0065751728,-0.028199358,0.0037449102,-0.03283989,0.022939205,-0.014124266,-0.024578623,0.0023573576,-0.026472872,-0.036904667,-0.011860529,0.0047565512,0.0007944863,0.011097723,0.018105654,0.022183297,0.025989903,-0.051727135,0.05144431,-0.031695165,0.004299326,0.023842758,0.026180219,-0.011605663,-0.024851374,-0.018853374,-0.65918696,-0.00006624681,0.017555635,-0.014242881,0.03384223,-0.011171142,-0.012985082,-0.0035719904,-0.019744495,-0.0025450834,-0.0047572292,0.004270088,0.0022473014,0.0035602194,0.01712484,-0.047339574,-0.00081340596,-0.030464904,-0.0070345826,-0.005436454,-0.0029675616,-0.033620015,0.002416907,-0.014087227,0.006006618,0.051765047,-0.00847126,-0.015693748,-0.00007432845,-0.02962299,0.0024098924,-0.023251021,-0.027604371,0.07248158,-0.006768571,-0.010117162,-0.000853718,-0.012253821,-0.02317061,-0.0443034,0.024170702,-0.09452875,-0.01663633,0.018952724,0.08154196,-0.020090159,0.007994159,-0.021025147,-0.010815593,-0.013434607,0.010226361,-0.024211043,0.002582354,0.00051920186,0.03070757,-0.017357782,0.0076094917,0.052744526,-0.02502156,0.017323982,0.0069558835,0.00320187,-0.0121615715,-0.006114673,-0.01860865,-0.052053045,-0.064390615,-0.0009381979,0.0143677825,-0.003132635,-0.0065016067,0.010687997,0.022177039,0.01045237,0.012964005,-0.031218588,0.031913422,-0.026354086,-0.013343591,0.031381387,0.0035105892,-0.017837284,-0.013447741,0.020642845,-0.0045488006,-0.023058502,-0.04733512,-0.015101456,-0.057333995,-0.027479475,0.004632223,0.018393159,-0.0045483606,-0.015590168,0.028626148,0.009040794,-0.0069780895,0.011160267,0.021909995,-0.018450577,0.0065916115,-0.017620232,0.018373724,-0.058276985,-0.04895028,-0.027228301,-0.027502628,0.031978335,0.0040025124,-0.011018322,0.011552936,-0.02360718,0.045139506,0.013830524,-0.012658997,0.0034000005,-0.0118152425,-0.007205212,0.0027947137,-0.026724147,-0.026476607,0.06409519,-0.021094838,-0.0014224577,-0.011470835,-0.03969559,-0.003061929,0.007293004,-0.01040206,-0.027418243,-0.047214627,0.016533362,0.027750151,-0.0031811506,0.025081648,0.012166864,-0.0072390838,-0.070326984,-0.02398082,0.038210325,0.002855612,0.016858,-0.00013064449,-0.016767884,0.021348398,0.010996726,0.046517856,0.015541411,-0.036558006,0.0143376095,-0.051828798,-0.049250472,0.014515377,-0.03540882,-0.013584696,0.03885138,0.009245851,0.01490699,-0.0006297302,-0.06761882,0.039366562,0.008090037,0.074893355,0.008768121,-0.015213993,0.056502774,-0.0065192683,0.029967483,-0.0124476245,0.02330298,-0.010233994,-0.042763136,0.0047870954,-0.028017653,-0.0011402722,0.013433945,0.023761822,-0.012503051,-0.019255424,-0.0087341145,-0.004373493,-0.06370518,-0.03597344,0.028186416,0.018644754,-0.025747348,-0.018697204,-0.014481455,-0.008948688,-0.05394029,-0.033483084,-0.021754108,0.029253455,-0.008016146,0.019218074,-0.030366471,0.024945274,0.041921575,-0.03724111,0.008069963,0.008233783,0.0038783874,-0.018608678,0.008524317,-0.027601853,-0.03654877,0.0015388042,0.0023280082,0.030197207,-0.009033678,-0.02840772,-0.00032916697,-0.015801374,-0.0063187955,0.033361573,-0.0034761445,-0.004090238,0.016985262,-0.021493701,0.0178043,-0.016354477,-0.012076,0.0014823169,-0.035040166,-0.038165715,0.012646827,0.046877623,0.029029887,0.01383131,-0.005316106,0.00208547,-0.0895642,-0.0022456236,0.039018083,0.021354707,0.0039480464,-0.011575888,-0.06013998,-0.0062865573,0.031894088,-0.018658523,0.012105281,-0.0039896043,-0.06613411,-0.008757345,0.0022830442,0.010554339,-0.0006705963,-0.023543384,0.025311308,-0.008726454,-0.034160126,-0.020077001,-0.03934334,0.049713023,-0.023072025,-0.012384749,0.0070140283,-0.006141672,0.0048660156,-0.023681814,-0.0067062248,-0.0046423776,0.011407563,0.03571631,0.017107999,-0.00030428712,-0.026876807,0.03822556,-0.03345483,-0.006246293,-0.030252803,-0.034432195,-0.0021775565,-0.019802166,0.056140088,-0.028532835,-0.052675247,0.043816723,-0.08099074,-0.017968936,0.011326453,-0.05024248,0.002725358,0.018453741,-0.03593788,0.021340003,-0.02033281,-0.047587294,-0.035302576,0.03278913,0.002827121,0.0037810311,-0.040139146,-0.03952497,0.008340315,0.024286706,0.019937936,-0.00959493,0.013380445,0.035678543,0.026339045,0.01900851,0.003153611,-0.025677262,-0.0107898805,0.009390115,-0.06420198,-0.02607503,-0.012662791,-0.049071673,-0.030406473,0.021251569,-0.003876445,-0.011002722,0.0069350475,0.0074343206,0.005540409,-0.015444208,-0.017500816,-0.01617281,0.009441845,0.027316578,-0.008633726,0.04041647,0.0253584,-0.02866278,0.0043085082,0.008170843,0.018523637,-0.006797902,0.022706065,0.024858413,0.027549835,0.0059863706,0.0007789611,0.009002973,-0.023701359,0.014581602,-0.008173515,0.00061665394,-0.025278933,0.022474391,0.037478153,0.00839686,0.0139904525,0.026219599,0.0108405715,0.0040541464,-0.0066938153,0.0176448,0.058813382,-0.0062193107,-0.0016875614,-0.0011812996,0.011085479,0.03968895,0.025684128,0.019306304,0.044123348,0.01593587,0.04749597,0.007322186,-0.04837524,-0.06940837,-0.0143790245,0.037696898,0.0068089035,-0.0043657445,0.001989694,-0.029734677,0.028486192,0.03292247,-0.009567871,0.0005995567,0.02393443,0.004537729,-0.016644467,-0.035086207,-0.0023174381,-0.011516366,-0.029172204,-0.013970994,-0.023908332,-0.007795749,0.0022495103,0.006393361,-0.012630243,-0.014140536,-0.06777402,0.0021128927,0.004641582,0.051619384,-0.026313715,-0.023768896,-0.012219177,0.048757337,-0.017484998,0.037887286,0.029593058,0.019161638,-0.0062865233,-0.054094046,0.030715639,0.029920619,0.028110499,-0.01340819,-0.013181068,0.007030826,-0.0037116734,-0.004884007,-0.021929542,-0.016535811,-0.02318427,0.003384872,0.007202729,0.01703826,0.012227894,-0.022330686,0.019824266,0.027007291,-0.0065412503,-0.0018299284,0.02309633,-0.04277211,-0.02468582,0.046875358,-0.017837577,-0.014004263,0.015150872,-0.0129405875,-0.013064045,-0.0046237595,0.058327742,0.0139909955,-0.0049583926,-0.0003114005,0.024603214,-0.04031175,-0.020719783,0.019275326,0.025520222,-0.008058182,0.0027588804,0.072700396,0.029090207,-0.034767393,-0.028347721,0.022881316,0.0019229273,-0.016857756,-0.013783754,-0.016739836,-0.01021088,-0.02677109,-0.048283234,0.016138345,0.02104434,-0.024168164,0.00988457]

try:
    search_results = client.query_points(
        collection_name=collection_name,
        query=query_vector,
        limit=5
    ).points

    print(f"Top {len(search_results)} search results:")
    for point in search_results:
        print(f"ID: {point.id}, Score: {point.score}, Payload: {point.payload}")

except Exception as e:
    print("Error fetching points:", e)